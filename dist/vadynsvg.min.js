!function(){"use strict";const t={version:"1",resultName:"result",rowCount:19,availableRowCount:19,data:[["Technology",180435,54400,834],["Engineering",80867,12300,432],["Sales",5e4,65004,344],["Operations",60714,48200,543]],columns:[{name:"bi76",label:"Department",type:"string"},{name:"bi77",label:"Revenue",type:"number",usage:"quantitative",aggregation:"totalCount",format:{name:"COMMA",width:12,precision:0,formatString:"COMMA12."}},{name:"bi78",label:"Expenses",type:"number",usage:"quantitative",aggregation:"totalCount",format:{name:"COMMA",width:12,precision:0,formatString:"COMMA12."}},{name:"bi79",label:"Employees",type:"number",usage:"quantitative",aggregation:"totalCount",format:{name:"COMMA",width:12,precision:0,formatString:"COMMA12."}}]};var e;function n(){let t={};return window.location.search.slice(window.location.search.indexOf("?")+1).split("&").forEach(e=>{e.includes("=")?t[decodeURIComponent(e.substr(0,e.indexOf("=")))]=decodeURIComponent(e.substr(e.indexOf("=")+1)):t[e]=""}),t}const a=/{{([^}]+)}}/g,s=/_x([0-9A-Za-z]+)_/g,i=/(?:^|,)(\w+)(?:$|,)/g,r=/([^:,]+)/g,o=/[-+]?[0-9]*\.?[0-9]+/g;function l(t){return"{"+t.replace(i,(function(t,e){return t.replace(e,e+":true")})).replace(r,(function(t,e){return"true"===t||"false"===t||o.test(t)?t:'"'+t+'"'}))+"}"}function m(t){let e={name:"",opts:{}};const n=(t=function(t){return t.replace(s,(function(t,e){return String.fromCharCode(parseInt("0x"+e))}))}(t)).match(a);if(n)if((t=n[0].slice(2,-2)).includes("|")){const n=t.split("|");e.name=n[0],e.opts=JSON.parse(l(n[1]))}else t.includes(":")?e.opts=JSON.parse(l(t)):e.name=t;return e}class c{constructor(t,e){this.values=new Map;for(let n=0;n<e.length;n+=1)n<t.length&&this.values.set(e[n],t[n])}set(t,e){this.values.set(t,e)}get(t){return this.values.get(t)}}class u{constructor(t,e){this.rows=[],this.cols=[],this.frmt={std:new Map,cmp:new Map};for(let n of t)this.rows.push(new c(n,e));this.cols=e}setColumnFormat(t,e,n=!1){this.cols.includes(t)&&(n?this.frmt.cmp.set(t,e):this.frmt.std.set(t,e))}setColumnFormats(t,e,n=!1){for(let a=0;a<t.length;a+=1)a<e.length&&this.setColumnFormat(t[a],e[a],n)}castColumn(t,e){if(this.cols.includes(t))for(let n of this.rows)n.set(t,e(n.get(t)))}set(t,e,n){if(t<this.rows.length){return this.rows[t].set(e,n)}}get(t,e,n=!1){const a=this.getRaw(t,e);return void 0!==a?n&&this.frmt.cmp.has(e)?this.frmt.cmp.get(e)?.format(a):this.frmt.std.has(e)?this.frmt.std.get(e)?.format(a):a.toString():"???"}getRaw(t,e){if(t<this.rows.length){return this.rows[t].get(e)}}static fromVA(t){let e=new u(t.data,t.columns.map(t=>t.label));t.columns.forEach(t=>{switch(t.type){case"number":e.castColumn(t.label,Number)}});const n=f(t);for(let t in n)e.setColumnFormat(t,n[t]);const a=f(t,!0);for(let t in a)e.setColumnFormat(t,a[t]);return e}}const h={DOLLAR:"NLMNLUSD",EURO:"NLMNLEUR",POUND:"NLMNLGBP",WON:"NLMNLCNY",YEN:"NLMNLJPY"};function p(t){var e=(t=Math.round(t))%3600,n=e%60;return{h:Math.floor(t/3600),m:Math.floor(e/60),s:Math.ceil(n)}}function f(t,e=!1){let n={};return t.columns.forEach(t=>n[t.label]=function(t,e=!1){const n=t.format;if(n){if("number"===t.type){let t={maximumFractionDigits:n.precision,minimumFractionDigits:n.precision};e&&(t.notation="compact",t.maximumSignificantDigits=3);for(let t in h)n.name===t&&(n.name=h[t]);return n.name.startsWith("NLMNI")?{format:e=>{if("number"==typeof e)return n.name.replace("NLMNI","")+new Intl.NumberFormat(navigator.language,t).format(e)}}:n.name.startsWith("TIME")?{format:t=>{if("number"==typeof t){const e=p(t);return(""+e.h).padStart(2,"0")+":"+(""+e.m).padStart(2,"0")+":"+(""+e.s).padStart(2,"0")}return"???"}}:n.name.startsWith("HOUR")?{format:t=>{if("number"==typeof t){const e=Math.floor(t/3600);return new Intl.NumberFormat(navigator.language).format(e)}return"???"}}:n.name.startsWith("HHMM")?{format:t=>{if("number"==typeof t){const e=p(t);return(""+e.h).padStart(2,"0")+":"+(""+e.m).padStart(2,"0")}return"???"}}:n.name.startsWith("MMSS")?{format:t=>{if("number"==typeof t){const e=Math.round(t),n=Math.floor(e/60),a=Math.ceil(e%3600%60);return(""+n).padStart(2,"0")+":"+(""+a).padStart(2,"0")}return"???"}}:(n.name.startsWith("NLMNL")?(t.style="currency",t.currency=n.name.replace("NLMNL","")):n.name.startsWith("PERCENT")?t.style="percent":n.name.startsWith("F")?t.useGrouping=!1:n.name.startsWith("BEST")&&(delete t.maximumFractionDigits,t.maximumSignificantDigits=n.width,e&&(t.maximumSignificantDigits=3)),{format:e=>"number"==typeof e?new Intl.NumberFormat(navigator.language,t).format(e):"???"})}if("date"===t.type)return{format:t=>"string"==typeof t?t:"???"}}return{format:t=>"string"==typeof t?t:"???"}}(t,e)),n}class d{constructor(t){this.element=t,this.opts={}}static getDynamics(t,e=["all"]){return[]}apply(t){}}class g extends d{constructor(t){super(t),this.template=this.element.textContent}static getDynamics(t,e=["all"]){let n=[];return t.querySelectorAll("text").forEach((function(t){t.children.length?n.push(...t.children):n.push(t)})),n=n.filter(t=>t.textContent&&t.textContent.match(a)),n.map(t=>new g(t))}apply(t){this.template&&(this.element.textContent=this.template.replace(a,function(e){const n=m(e);return n.opts.hasOwnProperty("c")&&n.opts.c?t.get(0,n.name,!0):t.get(0,n.name)}.bind({data:t})))}}class w extends d{constructor(t){super(t),this.message={resultName:"",version:"",rowCount:0,availableRowCount:0,data:[],columns:[]},this.resultName="",this.data=new u([],[]),this.initComplete=!1,this.instanceSVG="",this.dynamics=[],this.opts={svg:"test.svg",clean:"all",dynamics:"all"},this.init()}init(){var t;this.opts={...this.opts,...n()},fetch(this.opts.svg,{method:"GET"}).then(t=>t.text()).then(t=>{this.element.innerHTML=t;const e=this.element.querySelector("svg");if(e){!function(t,e=["all"]){(e.includes("all")||e.includes("text"))&&t.querySelectorAll("tspan").forEach((function(t){t.parentElement&&t.parentElement.hasAttribute("x")&&t.removeAttribute("x"),t.parentElement&&t.parentElement.hasAttribute("y")&&t.removeAttribute("y")}))}(e,this.opts.clean.split(","));const t=document.createElementNS("http://www.w3.org/2000/svg","g");t.classList.add("__instance__"),t.id="__instance_0001__",t.append(...[...e.children].filter(t=>"style"!==t.tagName)),e.append(t),this.dynamics=w.getDynamics(t),this.instanceSVG=t.innerHTML}this.initComplete=!0}).catch(t=>console.error("Error: ",t)),t=this.onDataReceived.bind(this),window.addEventListener("message",e=>{e&&e.data&&e.data.hasOwnProperty("data")&&t(e.data)},!1),function(t){const n=document.createEvent("Event");n.initEvent("resizeEndEvent",!1,!0),window.addEventListener("resizeEndEvent",(function(){t()})),window.addEventListener("resize",(function(){e&&clearTimeout(e),e=setTimeout((function(){window.dispatchEvent(n)}),25)}))}(this.draw.bind(this))}static getDynamics(t,e=["all"]){let n=[];return(e.includes("all")||e.includes("text"))&&n.push(...g.getDynamics(t)),n}apply(){this.initComplete?this.dynamics.forEach(t=>t.apply(this.data)):window.setTimeout(this.apply.bind(this),100)}draw(){}onDataReceived(t){this.message=t,this.resultName=this.message.resultName,this.data=u.fromVA(this.message),this.apply()}}document.addEventListener("DOMContentLoaded",(function(){let e=new w(document.body);(function(){try{return window.self!==window.top}catch(t){return!0}})()||e.onDataReceived(t)}))}();
